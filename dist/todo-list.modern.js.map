{"version":3,"file":"todo-list.modern.js","sources":["../src/index.ts"],"sourcesContent":["interface ITodoList extends HTMLElement {\n    _input: HTMLInputElement;\n    _submit: HTMLButtonElement;\n    _list: HTMLUListElement;\n    _todos: WeakMap<HTMLLIElement, string>;\n    _useLocal: boolean;\n    get _lastItem(): HTMLLIElement;\n    set _todosLocal(todo: string|string[]);\n    get _todosLocal():string[];\n    add(todo: string, shouldStore: boolean): void;\n    delete(todo: HTMLLIElement): void;\n    handleEvent(e: MouseEvent): void;\n    connectedCallback():void;\n    disconnectedCallback():void;\n}\n\ninterface ITodoUList extends HTMLUListElement {\n    children: HTMLCollectionOf<HTMLLIElement>;\n}\n\nclass TodoList extends HTMLElement implements ITodoList {\n    _todos = new WeakMap();\n    _input = this.querySelector<HTMLInputElement>('[ref=\"input\"]')!;\n    _submit = this.querySelector<HTMLButtonElement>('[ref=\"submit\"]')!;\n    _list = this.querySelector<ITodoUList>('[ref=\"list\"]')!;\n    _useLocal = this.hasAttribute('use-local');\n    static i = 1;\n    static getId() {\n        return this.i++\n    }\n    constructor() {\n        super();\n    }\n\n    get _lastItem() {\n        return this._list.children[this._list.children.length - 1];\n    }\n\n    set _todosLocal(todo: string|string[]) {\n        if (typeof todo === 'string') {\n            const data = JSON.parse(localStorage.getItem('todos') || '[]');\n            data.push(todo);\n            localStorage.setItem('todos', JSON.stringify(data));\n        } else if (Array.isArray(todo)) {\n            localStorage.setItem('todos', JSON.stringify(todo));\n        }\n    }\n\n    get _todosLocal(): string[] {\n        return JSON.parse(localStorage.getItem('todos') || '[]');\n    }\n\n    add(todo: string, shouldStore = this._useLocal) {\n        /*\n        const li = document.createElement('li', { is: 'todo-item' });\n        li.setAttribute('title', todo);\n        */\n        this._list.insertAdjacentHTML('beforeend', `<li>\n            <span>${todo}</span>\n            <button type=\"button\">&times; Clear</button>\n        </li>`)\n\n        this._todos.set(this._lastItem, todo);\n        this._input.value = '';\n        if (shouldStore) {\n            this._todosLocal = todo;\n        }\n    }\n\n    delete(todoElement: HTMLLIElement) {\n        if (this._todos.has(todoElement)) {\n            this._todos.delete(todoElement);\n            if (this._useLocal) {\n                const data = this._todosLocal;\n                const indexOfTodo = data.indexOf(todoElement.getAttribute('title')!);\n                data.splice(indexOfTodo, 1);\n                this._todosLocal = data;\n            }\n\n            todoElement.remove();\n        }\n    }\n\n    handleEvent({ target }) {\n        switch(true) {\n            case target.closest('[ref=\"submit\"]') && this._input.value !== '':\n                this.add(this._input.value);\n                break;\n            case target.closest('li > button'):\n                this.delete(target.closest('li'));\n                break;\n        }\n    }\n\n    connectedCallback() {\n        this._useLocal &&\n            this._todosLocal\n                .forEach(todo => this.add(todo, false));\n\n        this._submit.addEventListener('click', this);\n    }\n\n    disconnectedCallback() {\n        this._submit.removeEventListener('click', this);\n    }\n}\n\nwindow.customElements.define('todo-list', TodoList);"],"names":["TodoList","HTMLElement","getId","this","i","constructor","super","_todos","WeakMap","_input","querySelector","_submit","_list","_useLocal","hasAttribute","_lastItem","children","length","_todosLocal","todo","data","JSON","parse","localStorage","getItem","push","setItem","stringify","Array","isArray","add","shouldStore","insertAdjacentHTML","set","value","delete","todoElement","has","indexOfTodo","indexOf","getAttribute","splice","remove","handleEvent","target","closest","connectedCallback","forEach","addEventListener","disconnectedCallback","removeEventListener","window","customElements","define"],"mappings":"AAoBA,MAAMA,UAAiBC,YAOnB,YAAOC,GACH,OAAOC,KAAKC,GAChB,CACAC,WAAAA,GACIC,QAAQH,KAVZI,EAAS,IAAIC,QACbC,KAAAA,EAASN,KAAKO,cAAgC,iBAC9CC,KAAAA,EAAUR,KAAKO,cAAiC,kBAChDE,KAAAA,EAAQT,KAAKO,cAA0B,gBACvCG,KAAAA,EAAYV,KAAKW,aAAa,YAO9B,CAEA,KAAIC,GACA,OAAOZ,KAAKS,EAAMI,SAASb,KAAKS,EAAMI,SAASC,OAAS,EAC5D,CAEA,KAAIC,CAAYC,GACZ,GAAoB,iBAATA,EAAmB,CAC1B,MAAMC,EAAOC,KAAKC,MAAMC,aAAaC,QAAQ,UAAY,MACzDJ,EAAKK,KAAKN,GACVI,aAAaG,QAAQ,QAASL,KAAKM,UAAUP,GAChD,MAAUQ,MAAMC,QAAQV,IACrBI,aAAaG,QAAQ,QAASL,KAAKM,UAAUR,GAErD,CAEA,KAAID,GACA,OAAOG,KAAKC,MAAMC,aAAaC,QAAQ,UAAY,KACvD,CAEAM,GAAAA,CAAIX,EAAcY,EAAc5B,KAAKU,GAKjCV,KAAKS,EAAMoB,mBAAmB,YAAa,2BAC/Bb,qFAIZhB,KAAKI,EAAO0B,IAAI9B,KAAKY,EAAWI,GAChChB,KAAKM,EAAOyB,MAAQ,GAChBH,IACA5B,KAAKe,EAAcC,EAE3B,CAEAgB,OAAOC,GACH,GAAIjC,KAAKI,EAAO8B,IAAID,GAAc,CAE9B,GADAjC,KAAKI,EAAO4B,OAAOC,GACfjC,KAAKU,EAAW,CAChB,MAAMO,EAAOjB,KAAKe,EACZoB,EAAclB,EAAKmB,QAAQH,EAAYI,aAAa,UAC1DpB,EAAKqB,OAAOH,EAAa,GACzBnC,KAAKe,EAAcE,CACtB,CAEDgB,EAAYM,QACf,CACL,CAEAC,WAAAA,EAAYC,OAAEA,IACV,QAAO,GACH,KAAKA,EAAOC,QAAQ,mBAA2C,KAAtB1C,KAAKM,EAAOyB,MACjD/B,KAAK2B,IAAI3B,KAAKM,EAAOyB,OACrB,MACJ,KAAKU,EAAOC,QAAQ,eAChB1C,KAAKgC,OAAOS,EAAOC,QAAQ,OAGvC,CAEAC,iBAAAA,GACI3C,KAAKU,GACDV,KAAKe,EACA6B,QAAQ5B,GAAQhB,KAAK2B,IAAIX,GAAM,IAExChB,KAAKQ,EAAQqC,iBAAiB,QAAS7C,KAC3C,CAEA8C,oBAAAA,GACI9C,KAAKQ,EAAQuC,oBAAoB,QAAS/C,KAC9C,EApFEH,EAMKI,EAAI,EAiFf+C,OAAOC,eAAeC,OAAO,YAAarD"}